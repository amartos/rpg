# RPG

This software is a framework for 2D isometric RPG games. I built it to learn C
language.

You can use it if you want, but be aware that it is far from being complete
and bug-free.

## Installation

### requirements

This software is not yet designed to compile and run on other than GNU/Linux
platforms. It won't work on Windows, you can try on Unix based OS without any
guarantee of any kind.

For a successful compilation you will need gcc, the SDL2 library (including
SDL2\_image), the sqlite3 C library and python3.

Optionally, you will need the python3 argparse package as the `tsv_to_db.py`
converter script needs it.

For Debian, here are the full commands (python3 is likely already installed):

```sh
sudo apt install build-essential libsdl2-2.0-0 libsdl2-dev libsdl2-image-2.0-0 libsdl2-image-dev sqlite3 sqlite3-dev

# optional
sudo apt install python3-pip
pip3 install --user argparse
```

### (re)generate the assets database

This step is mandatory at first install. The sqlite database used by the
software in testing phase is not in the repo. To generate it, you can either use
the dedicated python script (it will need argparse, see above), or load the
database dump.

```sh
make load_db # load the db dump
# make generate_db # use the python script
```

You can also dump the database using:

```sh
make dump_db
```

### build from source

Once requirements are installed, just run `make`.

## Run

Launch the main executable located at `bin/exec` and click on the map to see
the characters moving.

You can quit by pressing `q` or any combination of keys that sends a kill
signal (as `ctrl+w` or whatever your OS' parameter is).

## Tests

Besides of the main software, you can also test the pathfinding and navigation
module:

```sh
make pathfinding_test
```

```sh
make navigation_test
```

The Makefile automatically run the executables.

To use the pathfiding test just click anywhere on the map, the calculated path
will appear as green tiles from the start (yellow tile) to the click location.

## Tools

### store TSV files into the database

The python script `tools/tsv_to_db.py` can convert TSV maps (as the ones
generated by [donjon.bin.sh](https://donjon.bin.sh/fantasy/dungeon/)) and
stores them properly into the database. See the help descrition from the
script:

```sh
python3 tools/tsv_to_db.py --help
```

### map creation

A map creation tool can be generated. The tool needs a name for the map, and
both width and height (in number of tiles):

```sh
make map_creator
bin/map_creator -n name_of_map -s widthxheight
```

Once opened, you will see a grid that can be filled by clicking on the tile. The
type of tile filled is represented by the cursor. For now, only two types are
available, and can be changed by hitting the `a` (ground) and `z` (wall) keys.
Pressing `F5` will reset the map, and right clicking on a tile will reset that
specific tile.

Once done, the tool will store the map in the database. Note that, for now, only
one map is loaded by the main program, thus you can't get the newly created map
to appear anywhere. You can however check its storage in the sqlite database.

## Bug report

For bug reporting and pull requests, please use the main repo at gitea
[here](https://gitea.com/amartos/rpg).

## Licenses

The software is under the MIT license. See the LICENSE file.

### assets

The cursors are homemade.

The tiles and characters were originally made by
[laetissima](https://opengameart.org/users/laetissima) and modified. The
original are CC0 and can be obtained
[here](https://opengameart.org/content/isometric-painted-game-assets).
